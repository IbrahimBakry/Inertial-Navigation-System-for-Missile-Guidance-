function B = Mat_B(Q)

B11 = Q(1)^2+Q(2)^2-Q(3)^2-Q(4)^2;
B12 = 2*(Q(2)*Q(3) - Q(1)*Q(4));
B13 = 2*(Q(2)*Q(4) + Q(1)*Q(3));

B21 = 2*(Q(2)*Q(3) + Q(1)*Q(4));
B22 = Q(1)^2 + Q(3)^2 - Q(4)^2 -Q(2)^2;
B23 = 2*(Q(4)*Q(3) - Q(1)*Q(2));
 
B31 = 2*(Q(2)*Q(4) - Q(1)*Q(3));
B32 = 2*(Q(3)*Q(4) + Q(1)*Q(2));
B33 = Q(1)^2 + Q(4)^2 - Q(2)^2 -Q(3)^2;

B = [B11  B12  B13 B21  B22  B23 B31  B32  B33];
end
